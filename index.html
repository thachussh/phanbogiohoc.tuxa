<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù (D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1, h2 {
            color: #333;
        }
        .section {
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .suggestion {
            color: orange;
            font-weight: bold;
        }
        .input-group {
            margin-bottom: 10px;
        }
        .input-group label {
            margin-right: 10px;
        }
        .input-group input, td input {
            padding: 5px;
            width: 60px;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            border: none;
            font-size: 14px;
        }
        .button:hover {
            background-color: #45a049;
        }
        .buttons-container {
            margin-top: 20px;
            text-align: center;
        }
        .total-row {
            font-weight: bold;
            background-color: #ffeeba;
        }
    </style>
</head>
<body>
    <h1 style="text-align:center">Ph√¢n b·ªï c√°c lo·∫°i gi·ªù <br> (D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</h1>

    <div class="section">
        <h2>Th√¥ng tin h·ªçc ph·∫ßn</h2>
        <div class="input-group">
            <label for="theory-credits">S·ªë t√≠n ch·ªâ l√Ω thuy·∫øt:</label>
            <input type="number" id="theory-credits" min="0" value="0">
        </div>
        <div class="input-group">
            <label for="practice-credits">S·ªë t√≠n ch·ªâ th·ª±c h√†nh:</label>
            <input type="number" id="practice-credits" min="0" value="0">
        </div>
        <p><strong>T·ªïng s·ªë t√≠n ch·ªâ:</strong> <span id="total-credits">0</span></p>
        <p><strong>T·ª± h·ªçc (ti·∫øt):</strong> <span id="self-study-periods">0</span></p>
        <p id="error-message" class="error" style="display: none;">L·ªói: T·ªïng t√≠n ch·ªâ kh√¥ng kh·ªõp!</p>
        <p id="suggestion-message" class="suggestion" style="display: none;">G·ª£i √Ω: C·∫ßn th√™m <span id="hours-needed">0</span> gi·ªù ƒë·ªÉ ƒë·∫°t t·ªïng <span id="hours-required">0</span> gi·ªù h·ªçc t·∫≠p.</p>
    </div>

    <div class="section">
        <h2>Ph√¢n b·ªï c·ª• th·ªÉ</h2>
        <table id="allocation-table">
            <thead>
                <tr>
                    <th>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù</th>
                    <th>L√Ω thuy·∫øt (ti·∫øt)</th>
                    <th>Th·ª±c h√†nh (ti·∫øt)</th>
                    <th>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u (ti·∫øt)</th>
                    <th>T·ªïng (gi·ªù)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="5"><strong>S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
                </tr>
                <tr>
                    <td>Tr·ª±c tuy·∫øn ƒë·ªìng b·ªô</td>
                    <td><input type="number" id="theory-sync" min="0" value="0"></td>
                    <td><input type="number" id="practice-sync" min="0" value="0"></td>
                    <td><input type="number" id="self-study-sync" min="0" value="0"></td>
                    <td id="total-sync">0</td>
                </tr>
                <tr>
                    <td>Tr·ª±c tuy·∫øn kh√¥ng ƒë·ªìng b·ªô</td>
                    <td><input type="number" id="theory-async" min="0" value="0"></td>
                    <td><input type="number" id="practice-async" min="0" value="0"></td>
                    <td><input type="number" id="self-study-async" min="0" value="0"></td>
                    <td id="total-async">0</td>
                </tr>
                <tr>
                    <td>LMS (c√≥ h∆∞·ªõng d·∫´n)</td>
                    <td><input type="number" id="theory-lms" min="0" value="0"></td>
                    <td><input type="number" id="practice-lms" min="0" value="0"></td>
                    <td><input type="number" id="self-study-lms" min="0" value="0"></td>
                    <td id="total-lms">0</td>
                </tr>
                <tr>
                    <td>Th∆∞ t√≠n, h·ªçc li·ªáu (n·∫øu c√≥)</td>
                    <td><input type="number" id="theory-correspondence" min="0" value="0"></td>
                    <td><input type="number" id="practice-correspondence" min="0" value="0"></td>
                    <td><input type="number" id="self-study-correspondence" min="0" value="0"></td>
                    <td id="total-correspondence">0</td>
                </tr>
                <tr class="total-row">
                    <td><strong>T·ªïng S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
                    <td id="total-theory-teaching">0</td>
                    <td id="total-practice-teaching">0</td>
                    <td id="total-self-study-teaching">0</td>
                    <td id="total-teaching-hours">0</td>
                </tr>
                <tr>
                    <td colspan="5"><strong>S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
                </tr>
                <tr>
                    <td>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u</td>
                    <td><input type="number" id="theory-self-study" min="0" value="0"></td>
                    <td><input type="number" id="practice-self-study" min="0" value="0"></td>
                    <td><input type="number" id="self-study-research" min="0" value="0"></td>
                    <td id="total-self-study">0</td>
                </tr>
                <tr>
                    <td>√în thi, d·ª± thi, ki·ªÉm tra</td>
                    <td><input type="number" id="theory-assessment" min="0" value="0"></td>
                    <td><input type="number" id="practice-assessment" min="0" value="0"></td>
                    <td><input type="number" id="self-study-assessment" min="0" value="0"></td>
                    <td id="total-assessment">0</td>
                </tr>
                <tr class="total-row">
                    <td><strong>T·ªïng S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
                    <td id="total-theory-other">0</td>
                    <td id="total-practice-other">0</td>
                    <td id="total-self-study-other">0</td>
                    <td id="total-other-hours">0</td>
                </tr>
                <tr class="total-row">
                    <td><strong>T·ªïng</strong></td>
                    <td id="total-theory">0</td>
                    <td id="total-practice">0</td>
                    <td id="total-self-study">0</td>
                    <td id="total-hours">0</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="buttons-container">
        <button class="button" onclick="exportToWord()">üìÑ T·∫£i file Word</button>
    </div>

    <script>
        // L·∫•y c√°c ph·∫ßn t·ª≠ input v√† output
        const theoryCreditsInput = document.getElementById('theory-credits');
        const practiceCreditsInput = document.getElementById('practice-credits');
        const totalCreditsSpan = document.getElementById('total-credits');
        const selfStudyPeriodsSpan = document.getElementById('self-study-periods');
        const errorMessage = document.getElementById('error-message');
        const suggestionMessage = document.getElementById('suggestion-message');
        const hoursNeededSpan = document.getElementById('hours-needed');
        const hoursRequiredSpan = document.getElementById('hours-required');

        const tableInputs = {
            theorySync: document.getElementById('theory-sync'),
            practiceSync: document.getElementById('practice-sync'),
            selfStudySync: document.getElementById('self-study-sync'),
            theoryAsync: document.getElementById('theory-async'),
            practiceAsync: document.getElementById('practice-async'),
            selfStudyAsync: document.getElementById('self-study-async'),
            theoryLms: document.getElementById('theory-lms'),
            practiceLms: document.getElementById('practice-lms'),
            selfStudyLms: document.getElementById('self-study-lms'),
            theoryCorrespondence: document.getElementById('theory-correspondence'),
            practiceCorrespondence: document.getElementById('practice-correspondence'),
            selfStudyCorrespondence: document.getElementById('self-study-correspondence'),
            theorySelfStudy: document.getElementById('theory-self-study'),
            practiceSelfStudy: document.getElementById('practice-self-study'),
            selfStudyResearch: document.getElementById('self-study-research'),
            theoryAssessment: document.getElementById('theory-assessment'),
            practiceAssessment: document.getElementById('practice-assessment'),
            selfStudyAssessment: document.getElementById('self-study-assessment')
        };

        const tableCells = {
            totalSync: document.getElementById('total-sync'),
            totalAsync: document.getElementById('total-async'),
            totalLms: document.getElementById('total-lms'),
            totalCorrespondence: document.getElementById('total-correspondence'),
            totalSelfStudy: document.getElementById('total-self-study'),
            totalAssessment: document.getElementById('total-assessment'),
            totalTheoryTeaching: document.getElementById('total-theory-teaching'),
            totalPracticeTeaching: document.getElementById('total-practice-teaching'),
            totalSelfStudyTeaching: document.getElementById('total-self-study-teaching'),
            totalTeachingHours: document.getElementById('total-teaching-hours'),
            totalTheoryOther: document.getElementById('total-theory-other'),
            totalPracticeOther: document.getElementById('total-practice-other'),
            totalSelfStudyOther: document.getElementById('total-self-study-other'),
            totalOtherHours: document.getElementById('total-other-hours'),
            totalTheory: document.getElementById('total-theory'),
            totalPractice: document.getElementById('total-practice'),
            totalSelfStudy: document.getElementById('total-self-study'),
            totalHours: document.getElementById('total-hours')
        };

        // H√†m t√≠nh to√°n v√† c·∫≠p nh·∫≠t b·∫£ng
        function updateAllocation() {
            // L·∫•y s·ªë t√≠n ch·ªâ t·ª´ input
            const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
            const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;

            // T√≠nh t·ªïng s·ªë t√≠n ch·ªâ v√† t·ª± h·ªçc
            const totalCredits = theoryCredits + practiceCredits;
            totalCreditsSpan.textContent = totalCredits;
            const selfStudyPeriods = totalCredits * 30; // T·ªïng s·ªë t√≠n ch·ªâ √ó 30 ti·∫øt
            selfStudyPeriodsSpan.textContent = Math.round(selfStudyPeriods);

            // G·ª£i √Ω ph√¢n b·ªï ban ƒë·∫ßu
            const suggestedTheorySync = theoryCredits * 7.5; // 15 ti·∫øt/t√≠n ch·ªâ chia ƒë·ªÅu
            const suggestedTheoryAsync = theoryCredits * 7.5;
            const suggestedPracticeSync = practiceCredits * 15; // 30 ti·∫øt/t√≠n ch·ªâ chia ƒë·ªÅu
            const suggestedPracticeAsync = practiceCredits * 15;
            const suggestedSelfStudyResearch = selfStudyPeriods; // T·ª± h·ªçc m·∫∑c ƒë·ªãnh v√†o T·ª± h·ªçc, t·ª± nghi√™n c·ª©u

            // ƒêi·ªÅn gi√° tr·ªã m·∫∑c ƒë·ªãnh n·∫øu √¥ input ch∆∞a ƒë∆∞·ª£c ch·ªânh s·ª≠a
            if (!tableInputs.theorySync.dataset.edited) tableInputs.theorySync.value = Math.round(suggestedTheorySync);
            if (!tableInputs.practiceSync.dataset.edited) tableInputs.practiceSync.value = Math.round(suggestedPracticeSync);
            if (!tableInputs.selfStudySync.dataset.edited) tableInputs.selfStudySync.value = 0;
            if (!tableInputs.theoryAsync.dataset.edited) tableInputs.theoryAsync.value = Math.round(suggestedTheoryAsync);
            if (!tableInputs.practiceAsync.dataset.edited) tableInputs.practiceAsync.value = Math.round(suggestedPracticeAsync);
            if (!tableInputs.selfStudyAsync.dataset.edited) tableInputs.selfStudyAsync.value = 0;
            if (!tableInputs.theoryLms.dataset.edited) tableInputs.theoryLms.value = 0;
            if (!tableInputs.practiceLms.dataset.edited) tableInputs.practiceLms.value = 0;
            if (!tableInputs.selfStudyLms.dataset.edited) tableInputs.selfStudyLms.value = 0;
            if (!tableInputs.theoryCorrespondence.dataset.edited) tableInputs.theoryCorrespondence.value = 0;
            if (!tableInputs.practiceCorrespondence.dataset.edited) tableInputs.practiceCorrespondence.value = 0;
            if (!tableInputs.selfStudyCorrespondence.dataset.edited) tableInputs.selfStudyCorrespondence.value = 0;
            if (!tableInputs.theorySelfStudy.dataset.edited) tableInputs.theorySelfStudy.value = 0;
            if (!tableInputs.practiceSelfStudy.dataset.edited) tableInputs.practiceSelfStudy.value = 0;
            if (!tableInputs.selfStudyResearch.dataset.edited) tableInputs.selfStudyResearch.value = Math.round(suggestedSelfStudyResearch);
            if (!tableInputs.theoryAssessment.dataset.edited) tableInputs.theoryAssessment.value = 0;
            if (!tableInputs.practiceAssessment.dataset.edited) tableInputs.practiceAssessment.value = 0;
            if (!tableInputs.selfStudyAssessment.dataset.edited) tableInputs.selfStudyAssessment.value = 0;

            // L·∫•y gi√° tr·ªã t·ª´ c√°c √¥ input
            const theorySync = parseFloat(tableInputs.theorySync.value) || 0;
            const practiceSync = parseFloat(tableInputs.practiceSync.value) || 0;
            const selfStudySync = parseFloat(tableInputs.selfStudySync.value) || 0;
            const theoryAsync = parseFloat(tableInputs.theoryAsync.value) || 0;
            const practiceAsync = parseFloat(tableInputs.practiceAsync.value) || 0;
            const selfStudyAsync = parseFloat(tableInputs.selfStudyAsync.value) || 0;
            const theoryLms = parseFloat(tableInputs.theoryLms.value) || 0;
            const practiceLms = parseFloat(tableInputs.practiceLms.value) || 0;
            const selfStudyLms = parseFloat(tableInputs.selfStudyLms.value) || 0;
            const theoryCorrespondence = parseFloat(tableInputs.theoryCorrespondence.value) || 0;
            const practiceCorrespondence = parseFloat(tableInputs.practiceCorrespondence.value) || 0;
            const selfStudyCorrespondence = parseFloat(tableInputs.selfStudyCorrespondence.value) || 0;
            const theorySelfStudy = parseFloat(tableInputs.theorySelfStudy.value) || 0;
            const practiceSelfStudy = parseFloat(tableInputs.practiceSelfStudy.value) || 0;
            const selfStudyResearch = parseFloat(tableInputs.selfStudyResearch.value) || 0;
            const theoryAssessment = parseFloat(tableInputs.theoryAssessment.value) || 0;
            const practiceAssessment = parseFloat(tableInputs.practiceAssessment.value) || 0;
            const selfStudyAssessment = parseFloat(tableInputs.selfStudyAssessment.value) || 0;

            // T√≠nh t·ªïng s·ªë ti·∫øt cho m·ªói h√†ng
            const totalSyncPeriods = theorySync + practiceSync + selfStudySync;
            const totalAsyncPeriods = theoryAsync + practiceAsync + selfStudyAsync;
            const totalLmsPeriods = theoryLms + practiceLms + selfStudyLms;
            const totalCorrespondencePeriods = theoryCorrespondence + practiceCorrespondence + selfStudyCorrespondence;
            const totalSelfStudyPeriods = theorySelfStudy + practiceSelfStudy + selfStudyResearch;
            const totalAssessmentPeriods = theoryAssessment + practiceAssessment + selfStudyAssessment;

            // Quy ƒë·ªïi ti·∫øt sang gi·ªù (1 ti·∫øt = 50 ph√∫t)
            const totalSyncHours = (totalSyncPeriods * 50) / 60;
            const totalAsyncHours = (totalAsyncPeriods * 50) / 60;
            const totalLmsHours = (totalLmsPeriods * 50) / 60;
            const totalCorrespondenceHours = (totalCorrespondencePeriods * 50) / 60;
            const totalSelfStudyHours = (totalSelfStudyPeriods * 50) / 60;
            const totalAssessmentHours = (totalAssessmentPeriods * 50) / 60;

            // T√≠nh t·ªïng s·ªë ti·∫øt cho m·ªói c·ªôt
            const totalTheoryTeaching = theorySync + theoryAsync + theoryLms + theoryCorrespondence;
            const totalPracticeTeaching = practiceSync + practiceAsync + practiceLms + practiceCorrespondence;
            const totalSelfStudyTeaching = selfStudySync + selfStudyAsync + selfStudyLms + selfStudyCorrespondence;
            const totalTheoryOther = theorySelfStudy + theoryAssessment;
            const totalPracticeOther = practiceSelfStudy + practiceAssessment;
            const totalSelfStudyOther = selfStudyResearch + selfStudyAssessment;

            // T√≠nh t·ªïng gi·ªù
            const totalTeachingHours = totalSyncHours + totalAsyncHours + totalLmsHours + totalCorrespondenceHours;
            const totalOtherHours = totalSelfStudyHours + totalAssessmentHours;
            const totalHours = totalTeachingHours + totalOtherHours;

            // T√≠nh s·ªë gi·ªù y√™u c·∫ßu (50 gi·ªù/t√≠n ch·ªâ)
            const requiredHours = totalCredits * 50;
            const hoursNeeded = requiredHours - totalHours;

            // C·∫≠p nh·∫≠t b·∫£ng
            tableCells.totalSync.textContent = Math.round(totalSyncHours);
            tableCells.totalAsync.textContent = Math.round(totalAsyncHours);
            tableCells.totalLms.textContent = Math.round(totalLmsHours);
            tableCells.totalCorrespondence.textContent = Math.round(totalCorrespondenceHours);
            tableCells.totalSelfStudy.textContent = Math.round(totalSelfStudyHours);
            tableCells.totalAssessment.textContent = Math.round(totalAssessmentHours);
            tableCells.totalTheoryTeaching.textContent = Math.round(totalTheoryTeaching);
            tableCells.totalPracticeTeaching.textContent = Math.round(totalPracticeTeaching);
            tableCells.totalSelfStudyTeaching.textContent = Math.round(totalSelfStudyTeaching);
            tableCells.totalTeachingHours.textContent = Math.round(totalTeachingHours);
            tableCells.totalTheoryOther.textContent = Math.round(totalTheoryOther);
            tableCells.totalPracticeOther.textContent = Math.round(totalPracticeOther);
            tableCells.totalSelfStudyOther.textContent = Math.round(totalSelfStudyOther);
            tableCells.totalOtherHours.textContent = Math.round(totalOtherHours);
            tableCells.totalTheory.textContent = Math.round(totalTheoryTeaching + totalTheoryOther);
            tableCells.totalPractice.textContent = Math.round(totalPracticeTeaching + totalPracticeOther);
            tableCells.totalSelfStudy.textContent = Math.round(totalSelfStudyTeaching + totalSelfStudyOther);
            tableCells.totalHours.textContent = Math.round(totalHours);

            // Ki·ªÉm tra l·ªói
            errorMessage.style.display = 'none';
            suggestionMessage.style.display = 'none';
            errorMessage.classList.remove('success');
            if (totalCredits === 0) {
                errorMessage.textContent = 'L·ªói: Vui l√≤ng nh·∫≠p s·ªë t√≠n ch·ªâ l·ªõn h∆°n 0!';
                errorMessage.style.display = 'block';
            } else if (Math.abs(hoursNeeded) > 0.5) { // Ch√™nh l·ªách l·ªõn h∆°n 0.5 gi·ªù
                errorMessage.textContent = 'L·ªói: T·ªïng s·ªë gi·ªù ph√¢n b·ªï kh√¥ng kh·ªõp v·ªõi y√™u c·∫ßu!';
                errorMessage.style.display = 'block';
                if (hoursNeeded > 0) {
                    suggestionMessage.textContent = `G·ª£i √Ω: C·∫ßn th√™m ${Math.round(hoursNeeded)} gi·ªù ƒë·ªÉ ƒë·∫°t t·ªïng ${Math.round(requiredHours)} gi·ªù h·ªçc t·∫≠p.`;
                } else {
                    suggestionMessage.textContent = `G·ª£i √Ω: Ph√¢n b·ªï v∆∞·ª£t ${Math.round(-hoursNeeded)} gi·ªù so v·ªõi t·ªïng ${Math.round(requiredHours)} gi·ªù h·ªçc t·∫≠p.`;
                }
                suggestionMessage.style.display = 'block';
            } else {
                errorMessage.textContent = 'Ph√¢n b·ªï gi·ªù h·ªçc t·∫≠p ƒë√£ kh·ªõp!';
                errorMessage.classList.add('success');
                errorMessage.style.display = 'block';
            }

            // C·∫≠p nh·∫≠t th√¥ng b√°o g·ª£i √Ω
            hoursRequiredSpan.textContent = Math.round(requiredHours);
            hoursNeededSpan.textContent = Math.abs(Math.round(hoursNeeded));
        }

        // G·∫Øn s·ª± ki·ªán input v√† ƒë√°nh d·∫•u √¥ ƒë√£ ch·ªânh s·ª≠a
        function markAsEdited(event) {
            event.target.dataset.edited = 'true';
        }

        theoryCreditsInput.addEventListener('input', () => {
            Object.values(tableInputs).forEach(input => delete input.dataset.edited); // Reset edited state
            updateAllocation();
        });
        practiceCreditsInput.addEventListener('input', () => {
            Object.values(tableInputs).forEach(input => delete input.dataset.edited); // Reset edited state
            updateAllocation();
        });
        Object.values(tableInputs).forEach(input => {
            input.addEventListener('input', markAsEdited);
            input.addEventListener('input', updateAllocation);
        });

        // H√†m xu·∫•t ra file Word
        function exportToWord() {
            const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
            const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;
            const totalCredits = theoryCredits + practiceCredits;
            
            // T·∫°o n·ªôi dung HTML cho Word document
            const wordContent = `
                <html xmlns:o="urn:schemas-microsoft-com:office:office" 
                      xmlns:w="urn:schemas-microsoft-com:office:word" 
                      xmlns="http://www.w3.org/TR/REC-html40">
                <head>
                    <meta charset="utf-8">
                    <title>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù</title>
                    <!--[if gte mso 9]>
                    <xml>
                        <w:WordDocument>
                            <w:View>Print</w:View>
                            <w:Zoom>90</w:Zoom>
                            <w:DoNotPromptForConvert/>
                            <w:DoNotShowInsertionsAndDeletions/>
                        </w:WordDocument>
                    </xml>
                    <![endif]-->
                    <style>
                        body { font-family: 'Times New Roman', serif; font-size: 12pt; }
                        h1 { text-align: center; font-size: 16pt; font-weight: bold; }
                        h2 { font-size: 14pt; font-weight: bold; margin-top: 20px; }
                        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
                        th, td { border: 1px solid black; padding: 8px; text-align: center; }
                        th { background-color: #f2f2f2; font-weight: bold; }
                        .info-section { margin: 20px 0; }
                        .info-item { margin: 5px 0; }
                    </style>
                </head>
                <body>
                    <h1>PH√ÇN B·ªî C√ÅC LO·∫†I GI·ªú<br/>(D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</h1>
                    
                    <div class="info-section">
                        <h2>Th√¥ng tin h·ªçc ph·∫ßn</h2>
                        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ l√Ω thuy·∫øt:</strong> ${theoryCredits}</div>
                        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ th·ª±c h√†nh:</strong> ${practiceCredits}</div>
                        <div class="info-item"><strong>T·ªïng s·ªë t√≠n ch·ªâ:</strong> ${totalCredits}</div>
                        <div class="info-item"><strong>T·ª± h·ªçc (ti·∫øt):</strong> ${Math.round(totalCredits * 30)}</div>
                    </div>

                    <h2>Ph√¢n b·ªï c·ª• th·ªÉ</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù</th>
                                <th>L√Ω thuy·∫øt (ti·∫øt)</th>
                                <th>Th·ª±c h√†nh (ti·∫øt)</th>
                                <th>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u (ti·∫øt)</th>
                                <th>T·ªïng (gi·ªù)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5"><strong>S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
                            </tr>
                            <tr>
                                <td>Tr·ª±c tuy·∫øn ƒë·ªìng b·ªô</td>
                                <td>${tableInputs.theorySync.value}</td>
                                <td>${tableInputs.practiceSync.value}</td>
                                <td>${tableInputs.selfStudySync.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theorySync.value) + parseFloat(tableInputs.practiceSync.value) + parseFloat(tableInputs.selfStudySync.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td>Tr·ª±c tuy·∫øn kh√¥ng ƒë·ªìng b·ªô</td>
                                <td>${tableInputs.theoryAsync.value}</td>
                                <td>${tableInputs.practiceAsync.value}</td>
                                <td>${tableInputs.selfStudyAsync.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theoryAsync.value) + parseFloat(tableInputs.practiceAsync.value) + parseFloat(tableInputs.selfStudyAsync.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td>LMS (c√≥ h∆∞·ªõng d·∫´n)</td>
                                <td>${tableInputs.theoryLms.value}</td>
                                <td>${tableInputs.practiceLms.value}</td>
                                <td>${tableInputs.selfStudyLms.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theoryLms.value) + parseFloat(tableInputs.practiceLms.value) + parseFloat(tableInputs.selfStudyLms.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td>Th∆∞ t√≠n, h·ªçc li·ªáu (n·∫øu c√≥)</td>
                                <td>${tableInputs.theoryCorrespondence.value}</td>
                                <td>${tableInputs.practiceCorrespondence.value}</td>
                                <td>${tableInputs.selfStudyCorrespondence.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theoryCorrespondence.value) + parseFloat(tableInputs.practiceCorrespondence.value) + parseFloat(tableInputs.selfStudyCorrespondence.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td><strong>T·ªïng S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
                                <td><strong>${Math.round(
                                    parseFloat(tableInputs.theorySync.value) + 
                                    parseFloat(tableInputs.theoryAsync.value) + 
                                    parseFloat(tableInputs.theoryLms.value) + 
                                    parseFloat(tableInputs.theoryCorrespondence.value)
                                )}</strong></td>
                                <td><strong>${Math.round(
                                    parseFloat(tableInputs.practiceSync.value) + 
                                    parseFloat(tableInputs.practiceAsync.value) + 
                                    parseFloat(tableInputs.practiceLms.value) + 
                                    parseFloat(tableInputs.practiceCorrespondence.value)
                                )}</strong></td>
                                <td><strong>${Math.round(
                                    parseFloat(tableInputs.selfStudySync.value) + 
                                    parseFloat(tableInputs.selfStudyAsync.value) + 
                                    parseFloat(tableInputs.selfStudyLms.value) + 
                                    parseFloat(tableInputs.selfStudyCorrespondence.value)
                                )}</strong></td>
                                <td><strong>${
                                    Math.round(
                                        (parseFloat(tableInputs.theorySync.value) + parseFloat(tableInputs.practiceSync.value) + parseFloat(tableInputs.selfStudySync.value) +
                                        parseFloat(tableInputs.theoryAsync.value) + parseFloat(tableInputs.practiceAsync.value) + parseFloat(tableInputs.selfStudyAsync.value) +
                                        parseFloat(tableInputs.theoryLms.value) + parseFloat(tableInputs.practiceLms.value) + parseFloat(tableInputs.selfStudyLms.value) +
                                        parseFloat(tableInputs.theoryCorrespondence.value) + parseFloat(tableInputs.practiceCorrespondence.value) + parseFloat(tableInputs.selfStudyCorrespondence.value)
                                    ) * 50 / 60
                                    )
                                }</strong></td>
                            </tr>
                            <tr>
                                <td colspan="5"><strong>S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
                            </tr>
                            <tr>
                                <td>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u</td>
                                <td>${tableInputs.theorySelfStudy.value}</td>
                                <td>${tableInputs.practiceSelfStudy.value}</td>
                                <td>${tableInputs.selfStudyResearch.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theorySelfStudy.value) + parseFloat(tableInputs.practiceSelfStudy.value) + parseFloat(tableInputs.selfStudyResearch.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td>√în thi, d·ª± thi, ki·ªÉm tra</td>
                                <td>${tableInputs.theoryAssessment.value}</td>
                                <td>${tableInputs.practiceAssessment.value}</td>
                                <td>${tableInputs.selfStudyAssessment.value}</td>
                                <td>${Math.round((parseFloat(tableInputs.theoryAssessment.value) + parseFloat(tableInputs.practiceAssessment.value) + parseFloat(tableInputs.selfStudyAssessment.value)) * 50 / 60)}</td>
                            </tr>
                            <tr>
                                <td><strong>T·ªïng S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
                                <td><strong>${Math.round(parseFloat(tableInputs.theorySelfStudy.value) + parseFloat(tableInputs.theoryAssessment.value))}</strong></td>
                                <td><strong>${Math.round(parseFloat(tableInputs.practiceSelfStudy.value) + parseFloat(tableInputs.practiceAssessment.value))}</strong></td>
                                <td><strong>${Math.round(parseFloat(tableInputs.selfStudyResearch.value) + parseFloat(tableInputs.selfStudyAssessment.value))}</strong></td>
                                <td><strong>${
                                    Math.round(
                                        (parseFloat(tableInputs.theorySelfStudy.value) + parseFloat(tableInputs.practiceSelfStudy.value) + parseFloat(tableInputs.selfStudyResearch.value) +
                                        parseFloat(tableInputs.theoryAssessment.value) + parseFloat(tableInputs.practiceAssessment.value) + parseFloat(tableInputs.selfStudyAssessment.value)
                                    ) * 50 / 60
                                    )
                                }</strong></td>
                            </tr>
                            <tr>
                                <td><strong>T·ªîNG</strong></td>
                                <td><strong>${
                                    Math.round(
                                        parseFloat(tableInputs.theorySync.value) + parseFloat(tableInputs.theoryAsync.value) + parseFloat(tableInputs.theoryLms.value) + parseFloat(tableInputs.theoryCorrespondence.value) +
                                        parseFloat(tableInputs.theorySelfStudy.value) + parseFloat(tableInputs.theoryAssessment.value)
                                    )
                                }</strong></td>
                                <td><strong>${
                                    Math.round(
                                        parseFloat(tableInputs.practiceSync.value) + parseFloat(tableInputs.practiceAsync.value) + parseFloat(tableInputs.practiceLms.value) + parseFloat(tableInputs.practiceCorrespondence.value) +
                                        parseFloat(tableInputs.practiceSelfStudy.value) + parseFloat(tableInputs.practiceAssessment.value)
                                    )
                                }</strong></td>
                                <td><strong>${
                                    Math.round(
                                        parseFloat(tableInputs.selfStudySync.value) + parseFloat(tableInputs.selfStudyAsync.value) + parseFloat(tableInputs.selfStudyLms.value) + parseFloat(tableInputs.selfStudyCorrespondence.value) +
                                        parseFloat(tableInputs.selfStudyResearch.value) + parseFloat(tableInputs.selfStudyAssessment.value)
                                    )
                                }</strong></td>
                                <td><strong>${
                                    Math.round(
                                        (
                                            parseFloat(tableInputs.theorySync.value) + parseFloat(tableInputs.practiceSync.value) + parseFloat(tableInputs.selfStudySync.value) +
                                            parseFloat(tableInputs.theoryAsync.value) + parseFloat(tableInputs.practiceAsync.value) + parseFloat(tableInputs.selfStudyAsync.value) +
                                            parseFloat(tableInputs.theoryLms.value) + parseFloat(tableInputs.practiceLms.value) + parseFloat(tableInputs.selfStudyLms.value) +
                                            parseFloat(tableInputs.theoryCorrespondence.value) + parseFloat(tableInputs.practiceCorrespondence.value) + parseFloat(tableInputs.selfStudyCorrespondence.value) +
                                            parseFloat(tableInputs.theorySelfStudy.value) + parseFloat(tableInputs.practiceSelfStudy.value) + parseFloat(tableInputs.selfStudyResearch.value) +
                                            parseFloat(tableInputs.theoryAssessment.value) + parseFloat(tableInputs.practiceAssessment.value) + parseFloat(tableInputs.selfStudyAssessment.value)
                                        ) * 50 / 60
                                    )
                                }</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="info-section">
                        <p><strong>Ghi ch√∫:</strong></p>
                        <ul>
                            <li>1 ti·∫øt = 50 ph√∫t</li>
                            <li>T·ªïng s·ªë gi·ªù y√™u c·∫ßu: ${Math.round(totalCredits * 50)} gi·ªù</li>
                            <li>Ng√†y t·∫°o: ${new Date().toLocaleDateString('vi-VN')}</li>
                        </ul>
                    </div>
                </body>
                </html>
            `;

            // T·∫°o Blob v√† t·∫£i xu·ªëng
            const blob = new Blob(['\ufeff', wordContent], {
                type: 'application/msword'
            });
            
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `Phan_bo_gio_hoc_${totalCredits}tc_${new Date().getTime()}.doc`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('File Word ƒë√£ ƒë∆∞·ª£c t·∫°o v√† t·∫£i xu·ªëng!');
        }

        // Ch·∫°y l·∫ßn ƒë·∫ßu ƒë·ªÉ hi·ªÉn th·ªã gi√° tr·ªã m·∫∑c ƒë·ªãnh
        updateAllocation();
    </script>
</body>
</html>