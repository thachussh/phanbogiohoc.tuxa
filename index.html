<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân bổ các loại giờ (Dành cho hệ Đào tạo từ xa)</title>
    <script src="https://cdn.jsdelivr.net/npm/docx@7.8.2/build/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1, h2 {
            color: #333;
            text-align: center;
        }
        .section {
            margin-bottom: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .error, .suggestion {
            color: red;
            font-weight: bold;
        }
        .input-group {
            margin-bottom: 10px;
        }
        .input-group label {
            margin-right: 10px;
        }
        .input-group input, td input {
            padding: 5px;
            width: 60px;
        }
        .button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 10px;
            cursor: pointer;
        }
        .button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Phân bổ các loại giờ (Dành cho hệ Đào tạo từ xa)</h1>

    <div class="section">
        <h2>Thông tin học phần</h2>
        <div class="input-group">
            <label for="theory-credits">Số tín chỉ lý thuyết:</label>
            <input type="number" id="theory-credits" min="0" value="0">
        </div>
        <div class="input-group">
            <label for="practice-credits">Số tín chỉ thực hành/thí nghiệm/thảo luận:</label>
            <input type="number" id="practice-credits" min="0" value="0">
        </div>
        <p><strong>Tổng số tín chỉ:</strong> <span id="total-credits">0</span></p>
        <p><strong>Tự học (tiết):</strong> <span id="self-study-periods">0</span></p>
        <p id="error-message" class="error" style="display: none;">Lỗi: Tổng tín chỉ không khớp!</p>
        <p id="suggestion-message" class="suggestion" style="display: none;">Gợi ý: Cần thêm <span id="hours-needed">0</span> giờ để đạt tổng <span id="hours-required">0</span> giờ học tập.</p>
    </div>

    <div class="section">
        <h2>Phân bổ cụ thể</h2>
        <table id="allocation-table">
            <thead>
                <tr>
                    <th>Phân bổ các loại giờ</th>
                    <th>Lý thuyết (tiết)</th>
                    <th>Thực hành/Thí nghiệm/Thảo luận (tiết)</th>
                    <th>Tự học, tự nghiên cứu (tiết)</th>
                    <th>Tổng (giờ)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="5"><strong>Số giờ giảng dạy trực diện, trực tuyến</strong></td>
                </tr>
                <tr>
                    <td>Trực diện (tại phòng học)</td>
                    <td><input type="number" id="theory-classroom" min="0" value="0"></td>
                    <td><input type="number" id="practice-classroom" min="0" value="0"></td>
                    <td><input type="number" id="self-study-classroom" min="0" value="0"></td>
                    <td id="total-classroom">0</td>
                </tr>
                <tr>
                    <td>Trực tuyến (đồng bộ hoặc không đồng bộ)</td>
                    <td><input type="number" id="theory-online" min="0" value="0"></td>
                    <td><input type="number" id="practice-online" min="0" value="0"></td>
                    <td><input type="number" id="self-study-online" min="0" value="0"></td>
                    <td id="total-online">0</td>
                </tr>
                <tr>
                    <td>Đi thực tế, trải nghiệm</td>
                    <td><input type="number" id="theory-field" min="0" value="0"></td>
                    <td><input type="number" id="practice-field" min="0" value="0"></td>
                    <td><input type="number" id="self-study-field" min="0" value="0"></td>
                    <td id="total-field">0</td>
                </tr>
                <tr>
                    <td>LMS (có hướng dẫn)</td>
                    <td><input type="number" id="theory-lms" min="0" value="0"></td>
                    <td><input type="number" id="practice-lms" min="0" value="0"></td>
                    <td><input type="number" id="self-study-lms" min="0" value="0"></td>
                    <td id="total-lms">0</td>
                </tr>
                <tr>
                    <td><strong>Tổng Số giờ giảng dạy trực diện, trực tuyến</strong></td>
                    <td id="total-theory-teaching">0</td>
                    <td id="total-practice-teaching">0</td>
                    <td id="total-self-study-teaching">0</td>
                    <td id="total-teaching-hours">0</td>
                </tr>
                <tr>
                    <td colspan="5"><strong>Số giờ tự học và khác</strong></td>
                </tr>
                <tr>
                    <td>Tự học, tự nghiên cứu</td>
                    <td><input type="number" id="theory-self-study" min="0" value="0"></td>
                    <td><input type="number" id="practice-self-study" min="0" value="0"></td>
                    <td><input type="number" id="self-study-research" min="0" value="0"></td>
                    <td id="total-self-study">0</td>
                </tr>
                <tr>
                    <td>Làm việc nhóm</td>
                    <td><input type="number" id="theory-group" min="0" value="0"></td>
                    <td><input type="number" id="practice-group" min="0" value="0"></td>
                    <td><input type="number" id="self-study-group" min="0" value="0"></td>
                    <td id="total-group">0</td>
                </tr>
                <tr>
                    <td>Hoạt động học tập trên LMS</td>
                    <td><input type="number" id="theory-lms-activity" min="0" value="0"></td>
                    <td><input type="number" id="practice-lms-activity" min="0" value="0"></td>
                    <td><input type="number" id="self-study-lms-activity" min="0" value="0"></td>
                    <td id="total-lms-activity">0</td>
                </tr>
                <tr>
                    <td>Ôn thi, dự thi, kiểm tra</td>
                    <td><input type="number" id="theory-assessment" min="0" value="0"></td>
                    <td><input type="number" id="practice-assessment" min="0" value="0"></td>
                    <td><input type="number" id="self-study-assessment" min="0" value="0"></td>
                    <td id="total-assessment">0</td>
                </tr>
                <tr>
                    <td><strong>Tổng Số giờ tự học và khác</strong></td>
                    <td id="total-theory-other">0</td>
                    <td id="total-practice-other">0</td>
                    <td id="total-self-study-other">0</td>
                    <td id="total-other-hours">0</td>
                </tr>
                <tr>
                    <td><strong>Tổng</strong></td>
                    <td id="total-theory">0</td>
                    <td id="total-practice">0</td>
                    <td id="total-self-study">0</td>
                    <td id="total-hours">0</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div>
        <a href="#" class="button" onclick="exportToWord()">Tải file Word</a>
    </div>

    <script>
        // Lấy các phần tử input và output
        const theoryCreditsInput = document.getElementById('theory-credits');
        const practiceCreditsInput = document.getElementById('practice-credits');
        const totalCreditsSpan = document.getElementById('total-credits');
        const selfStudyPeriodsSpan = document.getElementById('self-study-periods');
        const errorMessage = document.getElementById('error-message');
        const suggestionMessage = document.getElementById('suggestion-message');
        const hoursNeededSpan = document.getElementById('hours-needed');
        const hoursRequiredSpan = document.getElementById('hours-required');
        const tableInputs = {
            theoryClassroom: document.getElementById('theory-classroom'),
            practiceClassroom: document.getElementById('practice-classroom'),
            selfStudyClassroom: document.getElementById('self-study-classroom'),
            theoryOnline: document.getElementById('theory-online'),
            practiceOnline: document.getElementById('practice-online'),
            selfStudyOnline: document.getElementById('self-study-online'),
            theoryField: document.getElementById('theory-field'),
            practiceField: document.getElementById('practice-field'),
            selfStudyField: document.getElementById('self-study-field'),
            theoryLms: document.getElementById('theory-lms'),
            practiceLms: document.getElementById('practice-lms'),
            selfStudyLms: document.getElementById('self-study-lms'),
            theorySelfStudy: document.getElementById('theory-self-study'),
            practiceSelfStudy: document.getElementById('practice-self-study'),
            selfStudyResearch: document.getElementById('self-study-research'),
            theoryGroup: document.getElementById('theory-group'),
            practiceGroup: document.getElementById('practice-group'),
            selfStudyGroup: document.getElementById('self-study-group'),
            theoryLmsActivity: document.getElementById('theory-lms-activity'),
            practiceLmsActivity: document.getElementById('practice-lms-activity'),
            selfStudyLmsActivity: document.getElementById('self-study-lms-activity'),
            theoryAssessment: document.getElementById('theory-assessment'),
            practiceAssessment: document.getElementById('practice-assessment'),
            selfStudyAssessment: document.getElementById('self-study-assessment')
        };
        const tableCells = {
            totalClassroom: document.getElementById('total-classroom'),
            totalOnline: document.getElementById('total-online'),
            totalField: document.getElementById('total-field'),
            totalLms: document.getElementById('total-lms'),
            totalSelfStudy: document.getElementById('total-self-study'),
            totalGroup: document.getElementById('total-group'),
            totalLmsActivity: document.getElementById('total-lms-activity'),
            totalAssessment: document.getElementById('total-assessment'),
            totalTheoryTeaching: document.getElementById('total-theory-teaching'),
            totalPracticeTeaching: document.getElementById('total-practice-teaching'),
            totalSelfStudyTeaching: document.getElementById('total-self-study-teaching'),
            totalTeachingHours: document.getElementById('total-teaching-hours'),
            totalTheoryOther: document.getElementById('total-theory-other'),
            totalPracticeOther: document.getElementById('total-practice-other'),
            totalSelfStudyOther: document.getElementById('total-self-study-other'),
            totalOtherHours: document.getElementById('total-other-hours'),
            totalTheory: document.getElementById('total-theory'),
            totalPractice: document.getElementById('total-practice'),
            totalSelfStudy: document.getElementById('total-self-study'),
            totalHours: document.getElementById('total-hours')
        };

        // Hàm xuất file Word
        async function exportToWord() {
            const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType } = docx;
            const doc = new Document({
                sections: [{
                    properties: {},
                    children: [
                        new Paragraph({
                            text: 'Phân bổ các loại giờ (Dành cho hệ Đào tạo từ xa)',
                            heading: docx.HeadingLevel.HEADING_1,
                            alignment: docx.AlignmentType.CENTER
                        }),
                        new Paragraph({
                            text: `Số tín chỉ lý thuyết: ${theoryCreditsInput.value}`,
                            spacing: { after: 200 }
                        }),
                        new Paragraph({
                            text: `Số tín chỉ thực hành/thí nghiệm/thảo luận: ${practiceCreditsInput.value}`,
                            spacing: { after: 200 }
                        }),
                        new Paragraph({
                            text: `Tổng số tín chỉ: ${totalCreditsSpan.textContent}`,
                            spacing: { after: 200 }
                        }),
                        new Paragraph({
                            text: `Tự học (tiết): ${selfStudyPeriodsSpan.textContent}`,
                            spacing: { after: 200 }
                        }),
                        new Paragraph({
                            text: suggestionMessage.style.display === 'block' ? suggestionMessage.textContent : '',
                            spacing: { after: 200 }
                        }),
                        new Paragraph({
                            text: 'Phân bổ cụ thể',
                            heading: docx.HeadingLevel.HEADING_2
                        }),
                        new Table({
                            width: { size: 100, type: WidthType.PERCENTAGE },
                            rows: [
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Phân bổ các loại giờ'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph('Lý thuyết (tiết)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph('Thực hành/Thí nghiệm/Thảo luận (tiết)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph('Tự học, tự nghiên cứu (tiết)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph('Tổng (giờ)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Số giờ giảng dạy trực diện, trực tuyến'), columnSpan: 5, margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Trực diện (tại phòng học)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryClassroom.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceClassroom.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyClassroom.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalClassroom.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Trực tuyến (đồng bộ hoặc không đồng bộ)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryOnline.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceOnline.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyOnline.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalOnline.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Đi thực tế, trải nghiệm'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryField.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceField.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyField.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalField.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('LMS (có hướng dẫn)'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryLms.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceLms.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyLms.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalLms.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Tổng Số giờ giảng dạy trực diện, trực tuyến'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalTheoryTeaching.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalPracticeTeaching.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalSelfStudyTeaching.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalTeachingHours.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Số giờ tự học và khác'), columnSpan: 5, margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Tự học, tự nghiên cứu'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theorySelfStudy.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceSelfStudy.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyResearch.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalSelfStudy.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Làm việc nhóm'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryGroup.value), margins: { top: 100, bottom: 100, leds: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceGroup.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyGroup.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalGroup.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Hoạt động học tập trên LMS'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryLmsActivity.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceLmsActivity.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyLmsActivity.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalLmsActivity.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Ôn thi, dự thi, kiểm tra'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.theoryAssessment.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.practiceAssessment.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableInputs.selfStudyAssessment.value), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalAssessment.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Tổng Số giờ tự học và khác'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalTheoryOther.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalPracticeOther.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalSelfStudyOther.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalOtherHours.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                }),
                                new TableRow({
                                    children: [
                                        new TableCell({ content: new Paragraph('Tổng'), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalTheory.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalPractice.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalSelfStudy.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } }),
                                        new TableCell({ content: new Paragraph(tableCells.totalHours.textContent), margins: { top: 100, bottom: 100, left: 100, right: 100 } })
                                    ]
                                })
                            ]
                        })
                    ]
                }]
            });
            const blob = await Packer.toBlob(doc);
            saveAs(blob, 'PhanBoCacLoaiGio.docx');
        }

        // Hàm tính toán và cập nhật bảng
        function updateAllocation() {
            // Lấy số tín chỉ từ input
            const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
            const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;

            // Tính tổng số tín chỉ và tự học
            const totalCredits = theoryCredits + practiceCredits;
            totalCreditsSpan.textContent = totalCredits;
            const selfStudyPeriods = totalCredits * 30;
            selfStudyPeriodsSpan.textContent = selfStudyPeriods.toFixed(1);

            // Gợi ý phân bổ ban đầu
            const suggestedTheoryOnline = theoryCredits * 7.5;
            const suggestedPracticeOnline = practiceCredits * 15;
            const suggestedSelfStudyResearch = selfStudyPeriods;

            // Điền giá trị mặc định nếu ô input chưa được chỉnh sửa
            if (!tableInputs.theoryClassroom.dataset.edited) tableInputs.theoryClassroom.value = 0;
            if (!tableInputs.practiceClassroom.dataset.edited) tableInputs.practiceClassroom.value = 0;
            if (!tableInputs.selfStudyClassroom.dataset.edited) tableInputs.selfStudyClassroom.value = 0;
            if (!tableInputs.theoryOnline.dataset.edited) tableInputs.theoryOnline.value = suggestedTheoryOnline.toFixed(1);
            if (!tableInputs.practiceOnline.dataset.edited) tableInputs.practiceOnline.value = suggestedPracticeOnline.toFixed(1);
            if (!tableInputs.selfStudyOnline.dataset.edited) tableInputs.selfStudyOnline.value = 0;
            if (!tableInputs.theoryField.dataset.edited) tableInputs.theoryField.value = 0;
            if (!tableInputs.practiceField.dataset.edited) tableInputs.practiceField.value = 0;
            if (!tableInputs.selfStudyField.dataset.edited) tableInputs.selfStudyField.value = 0;
            if (!tableInputs.theoryLms.dataset.edited) tableInputs.theoryLms.value = 0;
            if (!tableInputs.practiceLms.dataset.edited) tableInputs.practiceLms.value = 0;
            if (!tableInputs.selfStudyLms.dataset.edited) tableInputs.selfStudyLms.value = 0;
            if (!tableInputs.theorySelfStudy.dataset.edited) tableInputs.theorySelfStudy.value = 0;
            if (!tableInputs.practiceSelfStudy.dataset.edited) tableInputs.practiceSelfStudy.value = 0;
            if (!tableInputs.selfStudyResearch.dataset.edited) tableInputs.selfStudyResearch.value = suggestedSelfStudyResearch.toFixed(1);
            if (!tableInputs.theoryGroup.dataset.edited) tableInputs.theoryGroup.value = 0;
            if (!tableInputs.practiceGroup.dataset.edited) tableInputs.practiceGroup.value = 0;
            if (!tableInputs.selfStudyGroup.dataset.edited) tableInputs.selfStudyGroup.value = 0;
            if (!tableInputs.theoryLmsActivity.dataset.edited) tableInputs.theoryLmsActivity.value = 0;
            if (!tableInputs.practiceLmsActivity.dataset.edited) tableInputs.practiceLmsActivity.value = 0;
            if (!tableInputs.selfStudyLmsActivity.dataset.edited) tableInputs.selfStudyLmsActivity.value = 0;
            if (!tableInputs.theoryAssessment.dataset.edited) tableInputs.theoryAssessment.value = 0;
            if (!tableInputs.practiceAssessment.dataset.edited) tableInputs.practiceAssessment.value = 0;
            if (!tableInputs.selfStudyAssessment.dataset.edited) tableInputs.selfStudyAssessment.value = 0;

            // Lấy giá trị từ các ô input
            const theoryClassroom = parseFloat(tableInputs.theoryClassroom.value) || 0;
            const practiceClassroom = parseFloat(tableInputs.practiceClassroom.value) || 0;
            const selfStudyClassroom = parseFloat(tableInputs.selfStudyClassroom.value) || 0;
            const theoryOnline = parseFloat(tableInputs.theoryOnline.value) || 0;
            const practiceOnline = parseFloat(tableInputs.practiceOnline.value) || 0;
            const selfStudyOnline = parseFloat(tableInputs.selfStudyOnline.value) || 0;
            const theoryField = parseFloat(tableInputs.theoryField.value) || 0;
            const practiceField = parseFloat(tableInputs.practiceField.value) || 0;
            const selfStudyField = parseFloat(tableInputs.selfStudyField.value) || 0;
            const theoryLms = parseFloat(tableInputs.theoryLms.value) || 0;
            const practiceLms = parseFloat(tableInputs.practiceLms.value) || 0;
            const selfStudyLms = parseFloat(tableInputs.selfStudyLms.value) || 0;
            const theorySelfStudy = parseFloat(tableInputs.theorySelfStudy.value) || 0;
            const practiceSelfStudy = parseFloat(tableInputs.practiceSelfStudy.value) || 0;
            const selfStudyResearch = parseFloat(tableInputs.selfStudyResearch.value) || 0;
            const theoryGroup = parseFloat(tableInputs.theoryGroup.value) || 0;
            const practiceGroup = parseFloat(tableInputs.practiceGroup.value) || 0;
            const selfStudyGroup = parseFloat(tableInputs.selfStudyGroup.value) || 0;
            const theoryLmsActivity = parseFloat(tableInputs.theoryLmsActivity.value) || 0;
            const practiceLmsActivity = parseFloat(tableInputs.practiceLmsActivity.value) || 0;
            const selfStudyLmsActivity = parseFloat(tableInputs.selfStudyLmsActivity.value) || 0;
            const theoryAssessment = parseFloat(tableInputs.theoryAssessment.value) || 0;
            const practiceAssessment = parseFloat(tableInputs.practiceAssessment.value) || 0;
            const selfStudyAssessment = parseFloat(tableInputs.selfStudyAssessment.value) || 0;

            // Tính tổng số tiết cho mỗi hàng
            const totalClassroomPeriods = theoryClassroom + practiceClassroom + selfStudyClassroom;
            const totalOnlinePeriods = theoryOnline + practiceOnline + selfStudyOnline;
            const totalFieldPeriods = theoryField + practiceField + selfStudyField;
            const totalLmsPeriods = theoryLms + practiceLms + selfStudyLms;
            const totalSelfStudyPeriods = theorySelfStudy + practiceSelfStudy + selfStudyResearch;
            const totalGroupPeriods = theoryGroup + practiceGroup + selfStudyGroup;
            const totalLmsActivityPeriods = theoryLmsActivity + practiceLmsActivity + selfStudyLmsActivity;
            const totalAssessmentPeriods = theoryAssessment + practiceAssessment + selfStudyAssessment;

            // Quy đổi tiết sang giờ
            const totalClassroomHours = (totalClassroomPeriods * 50) / 60;
            const totalOnlineHours = (totalOnlinePeriods * 50) / 60;
            const totalFieldHours = (totalFieldPeriods * 50) / 60;
            const totalLmsHours = (totalLmsPeriods * 50) / 60;
            const totalSelfStudyHours = (totalSelfStudyPeriods * 50) / 60;
            const totalGroupHours = (totalGroupPeriods * 50) / 60;
            const totalLmsActivityHours = (totalLmsActivityPeriods * 50) / 60;
            const totalAssessmentHours = (totalAssessmentPeriods * 50) / 60;

            // Tính tổng số tiết cho mỗi cột
            const totalTheoryTeaching = theoryClassroom + theoryOnline + theoryField + theoryLms;
            const totalPracticeTeaching = practiceClassroom + practiceOnline + practiceField + practiceLms;
            const totalSelfStudyTeaching = selfStudyClassroom + selfStudyOnline + selfStudyField + selfStudyLms;
            const totalTheoryOther = theorySelfStudy + theoryGroup + theoryLmsActivity + theoryAssessment;
            const totalPracticeOther = practiceSelfStudy + practiceGroup + practiceLmsActivity + practiceAssessment;
            const totalSelfStudyOther = selfStudyResearch + selfStudyGroup + selfStudyLmsActivity + selfStudyAssessment;

            // Tính tổng giờ
            const totalTeachingHours = totalClassroomHours + totalOnlineHours + totalFieldHours + totalLmsHours;
            const totalOtherHours = totalSelfStudyHours + totalGroupHours + totalLmsActivityHours + totalAssessmentHours;
            const totalHours = totalTeachingHours + totalOtherHours;

            // Tính số giờ yêu cầu (50 giờ/tín chỉ)
            const requiredHours = totalCredits * 50;
            const hoursNeeded = requiredHours - totalHours;

            // Cập nhật bảng
            tableCells.totalClassroom.textContent = totalClassroomHours.toFixed(2);
            tableCells.totalOnline.textContent = totalOnlineHours.toFixed(2);
            tableCells.totalField.textContent = totalFieldHours.toFixed(2);
            tableCells.totalLms.textContent = totalLmsHours.toFixed(2);
            tableCells.totalSelfStudy.textContent = totalSelfStudyHours.toFixed(2);
            tableCells.totalGroup.textContent = totalGroupHours.toFixed(2);
            tableCells.totalLmsActivity.textContent = totalLmsActivityHours.toFixed(2);
            tableCells.totalAssessment.textContent = totalAssessmentHours.toFixed(2);
            tableCells.totalTheoryTeaching.textContent = totalTheoryTeaching.toFixed(1);
            tableCells.totalPracticeTeaching.textContent = totalPracticeTeaching.toFixed(1);
            tableCells.totalSelfStudyTeaching.textContent = totalSelfStudyTeaching.toFixed(1);
            tableCells.totalTeachingHours.textContent = totalTeachingHours.toFixed(2);
            tableCells.totalTheoryOther.textContent = totalTheoryOther.toFixed(1);
            tableCells.totalPracticeOther.textContent = totalPracticeOther.toFixed(1);
            tableCells.totalSelfStudyOther.textContent = totalSelfStudyOther.toFixed(1);
            tableCells.totalOtherHours.textContent = totalOtherHours.toFixed(2);
            tableCells.totalTheory.textContent = (totalTheoryTeaching + totalTheoryOther).toFixed(1);
            tableCells.totalPractice.textContent = (totalPracticeTeaching + totalPracticeOther).toFixed(1);
            tableCells.totalSelfStudy.textContent = (totalSelfStudyTeaching + totalSelfStudyOther).toFixed(1);
            tableCells.totalHours.textContent = totalHours.toFixed(2);

            // Cập nhật thông báo gợi ý
            hoursRequiredSpan.textContent = requiredHours.toFixed(2);
            hoursNeededSpan.textContent = hoursNeeded > 0 ? hoursNeeded.toFixed(2) : 0;
            suggestionMessage.style.display = totalCredits > 0 && hoursNeeded > 0 ? 'block' : 'none';

            // Kiểm tra lỗi tín chỉ
            errorMessage.style.display = totalCredits === 0 ? 'block' : 'none';
        }

        // Gắn sự kiện input và đánh dấu ô đã chỉnh sửa
        function markAsEdited(event) {
            event.target.dataset.edited = 'true';
        }
        theoryCreditsInput.addEventListener('input', () => {
            Object.values(tableInputs).forEach(input => delete input.dataset.edited);
            updateAllocation();
        });
        practiceCreditsInput.addEventListener('input', () => {
            Object.values(tableInputs).forEach(input => delete input.dataset.edited);
            updateAllocation();
        });
        Object.values(tableInputs).forEach(input => {
            input.addEventListener('input', markAsEdited);
            input.addEventListener('input', updateAllocation);
        });

        // Chạy lần đầu để hiển thị giá trị mặc định
        updateAllocation();
    </script>
</body>
</html>