<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù (D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        h1, h2 { color: #333; }
        .section { margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .error, .suggestion { color: red; font-weight: bold; }
        .input-group { margin-bottom: 10px; }
        .input-group label { margin-right: 10px; }
        .input-group input, td input { padding: 5px; width: 60px; }
        .button { display: inline-block; padding: 10px 20px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 5px; margin: 5px; cursor: pointer; border: none; font-size: 14px; }
        .button:hover { background-color: #45a049; }
        .button-secondary { background-color: #008CBA; }
        .button-secondary:hover { background-color: #007B9A; }
        .buttons-container { margin-top: 20px; }
        .total-row { font-weight: bold; background-color: #ffeeba; }
    </style>
</head>
<body>
    <h1 style="text-align:center">Ph√¢n b·ªï c√°c lo·∫°i gi·ªù <br> (D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</h1>

    <div class="section">
        <h2>Th√¥ng tin h·ªçc ph·∫ßn</h2>
        <div class="input-group">
            <label for="theory-credits">S·ªë t√≠n ch·ªâ l√Ω thuy·∫øt:</label>
            <input type="number" id="theory-credits" min="0" value="0">
        </div>
        <div class="input-group">
            <label for="practice-credits">S·ªë t√≠n ch·ªâ th·ª±c h√†nh:</label>
            <input type="number" id="practice-credits" min="0" value="0">
        </div>
        <p><strong>T·ªïng s·ªë t√≠n ch·ªâ:</strong> <span id="total-credits">0</span></p>
        <p><strong>T·ª± h·ªçc (ti·∫øt):</strong> <span id="self-study-periods">0</span></p>
        <p id="error-message" class="error" style="display: none;">L·ªói: T·ªïng t√≠n ch·ªâ kh√¥ng kh·ªõp!</p>
        <p id="suggestion-message" class="suggestion" style="display: none;">G·ª£i √Ω: C·∫ßn th√™m <span id="hours-needed">0</span> gi·ªù ƒë·ªÉ ƒë·∫°t t·ªïng <span id="hours-required">0</span> gi·ªù h·ªçc t·∫≠p.</p>
    </div>

    <div class="section">
        <h2>Ph√¢n b·ªï c·ª• th·ªÉ</h2>
        <table id="allocation-table">
            <thead>
                <tr>
                    <th>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù</th>
                    <th>L√Ω thuy·∫øt (ti·∫øt)</th>
                    <th>Th·ª±c h√†nh (ti·∫øt)</th>
                    <th>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u (ti·∫øt)</th>
                    <th>T·ªïng (gi·ªù)</th>
                </tr>
            </thead>
            <tbody>
             <tr>
                 <td colspan="5"><strong>S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
            </tr>
             <tr>
                 <td>Tr·ª±c tuy·∫øn ƒë·ªìng b·ªô</td>
                 <td><input type="number" id="theory-sync" min="0" value="0"></td>
                 <td><input type="number" id="practice-sync" min="0" value="0"></td>
                 <td><input type="number" id="self-study-sync" min="0" value="0"></td>
                 <td id="total-sync">0</td>
            </tr>
            <tr>
                 <td>Tr·ª±c tuy·∫øn kh√¥ng ƒë·ªìng b·ªô</td>
                 <td><input type="number" id="theory-async" min="0" value="0"></td>
                 <td><input type="number" id="practice-async" min="0" value="0"></td>
                 <td><input type="number" id="self-study-async" min="0" value="0"></td>
                 <td id="total-async">0</td>
            </tr>
            <tr>
                 <td>LMS (c√≥ h∆∞·ªõng d·∫´n)</td>
                 <td><input type="number" id="theory-lms" min="0" value="0"></td>
                 <td><input type="number" id="practice-lms" min="0" value="0"></td>
                 <td><input type="number" id="self-study-lms" min="0" value="0"></td>
                 <td id="total-lms">0</td>
            </tr>
            <tr>
                 <td>Th∆∞ t√≠n, h·ªçc li·ªáu (n·∫øu c√≥)</td>
                 <td><input type="number" id="theory-correspondence" min="0" value="0"></td>
                 <td><input type="number" id="practice-correspondence" min="0" value="0"></td>
                 <td><input type="number" id="self-study-correspondence" min="0" value="0"></td>
                 <td id="total-correspondence">0</td>
            </tr>
            <tr class="total-row">
                 <td><strong>T·ªïng S·ªë gi·ªù gi·∫£ng d·∫°y, h·ªçc t·∫≠p</strong></td>
                 <td id="total-theory-teaching">0</td>
                 <td id="total-practice-teaching">0</td>
                 <td id="total-self-study-teaching">0</td>
                 <td id="total-teaching-hours">0</td>
            </tr>
            <tr>
            <td colspan="5"><strong>S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
            </tr>
            <tr>
                 <td>T·ª± h·ªçc, t·ª± nghi√™n c·ª©u</td>
                 <td><input type="number" id="theory-self-study" min="0" value="0"></td>
                 <td><input type="number" id="practice-self-study" min="0" value="0"></td>
                 <td><input type="number" id="self-study-research" min="0" value="0"></td>
                 <td id="total-self-study">0</td>
           </tr>
           <tr>
                 <td>√în thi, d·ª± thi, ki·ªÉm tra</td>
                 <td><input type="number" id="theory-assessment" min="0" value="0"></td>
                 <td><input type="number" id="practice-assessment" min="0" value="0"></td>
                 <td><input type="number" id="self-study-assessment" min="0" value="0"></td>
                 <td id="total-assessment">0</td>
           </tr>
           <tr class="total-row">
                 <td><strong>T·ªïng S·ªë gi·ªù t·ª± h·ªçc v√† kh√°c</strong></td>
                 <td id="total-theory-other">0</td>
                 <td id="total-practice-other">0</td>
                 <td id="total-self-study-other">0</td>
                 <td id="total-other-hours">0</td>
           </tr>
           <tr class="total-row">
                 <td><strong>T·ªïng</strong></td>
                 <td id="total-theory">0</td>
                 <td id="total-practice">0</td>
                 <td id="total-self-study">0</td>
                 <td id="total-hours">0</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="buttons-container">
        <button class="button" onclick="exportToWord()">üìÑ T·∫£i file Word</button>
        <button class="button button-secondary" onclick="exportToHTML()">üåê T·∫£i file HTML</button>
        <button class="button button-secondary" onclick="printTable()">üñ®Ô∏è In b·∫£ng</button>
    </div>

<script>
    // L·∫•y c√°c ph·∫ßn t·ª≠ input v√† output
    const theoryCreditsInput = document.getElementById('theory-credits');
    const practiceCreditsInput = document.getElementById('practice-credits');
    const totalCreditsSpan = document.getElementById('total-credits');
    const selfStudyPeriodsSpan = document.getElementById('self-study-periods');
    const errorMessage = document.getElementById('error-message');
    const suggestionMessage = document.getElementById('suggestion-message');
    const hoursNeededSpan = document.getElementById('hours-needed');
    const hoursRequiredSpan = document.getElementById('hours-required');
    
    const tableInputs = {
        theorySync: document.getElementById('theory-sync'),
        practiceSync: document.getElementById('practice-sync'),
        selfStudySync: document.getElementById('self-study-sync'),
        theoryAsync: document.getElementById('theory-async'),
        practiceAsync: document.getElementById('practice-async'),
        selfStudyAsync: document.getElementById('self-study-async'),
        theoryLms: document.getElementById('theory-lms'),
        practiceLms: document.getElementById('practice-lms'),
        selfStudyLms: document.getElementById('self-study-lms'),
        theoryCorrespondence: document.getElementById('theory-correspondence'),
        practiceCorrespondence: document.getElementById('practice-correspondence'),
        selfStudyCorrespondence: document.getElementById('self-study-correspondence'),
        theorySelfStudy: document.getElementById('theory-self-study'),
        practiceSelfStudy: document.getElementById('practice-self-study'),
        selfStudyResearch: document.getElementById('self-study-research'),
        theoryAssessment: document.getElementById('theory-assessment'),
        practiceAssessment: document.getElementById('practice-assessment'),
        selfStudyAssessment: document.getElementById('self-study-assessment')
    };
    
    const tableCells = {
        totalSync: document.getElementById('total-sync'),
        totalAsync: document.getElementById('total-async'),
        totalLms: document.getElementById('total-lms'),
        totalCorrespondence: document.getElementById('total-correspondence'),
        totalSelfStudy: document.getElementById('total-self-study'),
        totalAssessment: document.getElementById('total-assessment'),
        totalTheoryTeaching: document.getElementById('total-theory-teaching'),
        totalPracticeTeaching: document.getElementById('total-practice-teaching'),
        totalSelfStudyTeaching: document.getElementById('total-self-study-teaching'),
        totalTeachingHours: document.getElementById('total-teaching-hours'),
        totalTheoryOther: document.getElementById('total-theory-other'),
        totalPracticeOther: document.getElementById('total-practice-other'),
        totalSelfStudyOther: document.getElementById('total-self-study-other'),
        totalOtherHours: document.getElementById('total-other-hours'),
        totalTheory: document.getElementById('total-theory'),
        totalPractice: document.getElementById('total-practice'),
        totalSelfStudy: document.getElementById('total-self-study'),
        totalHours: document.getElementById('total-hours')
    };

    function updateAllocation() {
        const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
        const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;

        const totalCredits = theoryCredits + practiceCredits;
        totalCreditsSpan.textContent = totalCredits;
        const selfStudyPeriods = totalCredits * 30;
        selfStudyPeriodsSpan.textContent = Math.round(selfStudyPeriods);

        const suggestedTheorySync = theoryCredits * 7.5;
        const suggestedTheoryAsync = theoryCredits * 7.5;
        const suggestedPracticeSync = practiceCredits * 15;
        const suggestedPracticeAsync = practiceCredits * 15;
        const suggestedSelfStudyResearch = selfStudyPeriods;

        if (!tableInputs.theorySync.dataset.edited) tableInputs.theorySync.value = Math.round(suggestedTheorySync);
        if (!tableInputs.practiceSync.dataset.edited) tableInputs.practiceSync.value = Math.round(suggestedPracticeSync);
        if (!tableInputs.selfStudySync.dataset.edited) tableInputs.selfStudySync.value = 0;
        if (!tableInputs.theoryAsync.dataset.edited) tableInputs.theoryAsync.value = Math.round(suggestedTheoryAsync);
        if (!tableInputs.practiceAsync.dataset.edited) tableInputs.practiceAsync.value = Math.round(suggestedPracticeAsync);
        if (!tableInputs.selfStudyAsync.dataset.edited) tableInputs.selfStudyAsync.value = 0;
        if (!tableInputs.theoryLms.dataset.edited) tableInputs.theoryLms.value = 0;
        if (!tableInputs.practiceLms.dataset.edited) tableInputs.practiceLms.value = 0;
        if (!tableInputs.selfStudyLms.dataset.edited) tableInputs.selfStudyLms.value = 0;
        if (!tableInputs.theoryCorrespondence.dataset.edited) tableInputs.theoryCorrespondence.value = 0;
        if (!tableInputs.practiceCorrespondence.dataset.edited) tableInputs.practiceCorrespondence.value = 0;
        if (!tableInputs.selfStudyCorrespondence.dataset.edited) tableInputs.selfStudyCorrespondence.value = 0;
        if (!tableInputs.theorySelfStudy.dataset.edited) tableInputs.theorySelfStudy.value = 0;
        if (!tableInputs.practiceSelfStudy.dataset.edited) tableInputs.practiceSelfStudy.value = 0;
        if (!tableInputs.selfStudyResearch.dataset.edited) tableInputs.selfStudyResearch.value = Math.round(suggestedSelfStudyResearch);
        if (!tableInputs.theoryAssessment.dataset.edited) tableInputs.theoryAssessment.value = 0;
        if (!tableInputs.practiceAssessment.dataset.edited) tableInputs.practiceAssessment.value = 0;
        if (!tableInputs.selfStudyAssessment.dataset.edited) tableInputs.selfStudyAssessment.value = 0;

        const theorySync = parseFloat(tableInputs.theorySync.value) || 0;
        const practiceSync = parseFloat(tableInputs.practiceSync.value) || 0;
        const selfStudySync = parseFloat(tableInputs.selfStudySync.value) || 0;
        const theoryAsync = parseFloat(tableInputs.theoryAsync.value) || 0;
        const practiceAsync = parseFloat(tableInputs.practiceAsync.value) || 0;
        const selfStudyAsync = parseFloat(tableInputs.selfStudyAsync.value) || 0;
        const theoryLms = parseFloat(tableInputs.theoryLms.value) || 0;
        const practiceLms = parseFloat(tableInputs.practiceLms.value) || 0;
        const selfStudyLms = parseFloat(tableInputs.selfStudyLms.value) || 0;
        const theoryCorrespondence = parseFloat(tableInputs.theoryCorrespondence.value) || 0;
        const practiceCorrespondence = parseFloat(tableInputs.practiceCorrespondence.value) || 0;
        const selfStudyCorrespondence = parseFloat(tableInputs.selfStudyCorrespondence.value) || 0;
        const theorySelfStudy = parseFloat(tableInputs.theorySelfStudy.value) || 0;
        const practiceSelfStudy = parseFloat(tableInputs.practiceSelfStudy.value) || 0;
        const selfStudyResearch = parseFloat(tableInputs.selfStudyResearch.value) || 0;
        const theoryAssessment = parseFloat(tableInputs.theoryAssessment.value) || 0;
        const practiceAssessment = parseFloat(tableInputs.practiceAssessment.value) || 0;
        const selfStudyAssessment = parseFloat(tableInputs.selfStudyAssessment.value) || 0;

        const totalSyncPeriods = theorySync + practiceSync + selfStudySync;
        const totalAsyncPeriods = theoryAsync + practiceAsync + selfStudyAsync;
        const totalLmsPeriods = theoryLms + practiceLms + selfStudyLms;
        const totalCorrespondencePeriods = theoryCorrespondence + practiceCorrespondence + selfStudyCorrespondence;
        const totalSelfStudyPeriods = theorySelfStudy + practiceSelfStudy + selfStudyResearch;
        const totalAssessmentPeriods = theoryAssessment + practiceAssessment + selfStudyAssessment;

        // --- Quy ƒë·ªïi ti·∫øt sang gi·ªù v√† c·∫≠p nh·∫≠t chu·∫©n ch·ªânh ---
        tableCells.totalSync.textContent = ((totalSyncPeriods * 50) / 60).toFixed(1);
        tableCells.totalAsync.textContent = ((totalAsyncPeriods * 50) / 60).toFixed(1);
        tableCells.totalLms.textContent = ((totalLmsPeriods * 50) / 60).toFixed(1);
        tableCells.totalCorrespondence.textContent = ((totalCorrespondencePeriods * 50) / 60).toFixed(1);
        tableCells.totalSelfStudy.textContent = ((totalSelfStudyPeriods * 50) / 60).toFixed(1);
        tableCells.totalAssessment.textContent = ((totalAssessmentPeriods * 50) / 60).toFixed(1);

        const totalTheoryTeaching = theorySync + theoryAsync + theoryLms + theoryCorrespondence;
        const totalPracticeTeaching = practiceSync + practiceAsync + practiceLms + practiceCorrespondence;
        const totalSelfStudyTeaching = selfStudySync + selfStudyAsync + selfStudyLms + selfStudyCorrespondence;
        const totalTheoryOther = theorySelfStudy + theoryAssessment;
        const totalPracticeOther = practiceSelfStudy + practiceAssessment;
        const totalSelfStudyOther = selfStudyResearch + selfStudyAssessment;

        tableCells.totalTheoryTeaching.textContent = Math.round(totalTheoryTeaching);
        tableCells.totalPracticeTeaching.textContent = Math.round(totalPracticeTeaching);
        tableCells.totalSelfStudyTeaching.textContent = Math.round(totalSelfStudyTeaching);
        tableCells.totalTeachingHours.textContent = ((totalSyncPeriods + totalAsyncPeriods + totalLmsPeriods + totalCorrespondencePeriods) * 50 / 60).toFixed(1);
        tableCells.totalTheoryOther.textContent = Math.round(totalTheoryOther);
        tableCells.totalPracticeOther.textContent = Math.round(totalPracticeOther);
        tableCells.totalSelfStudyOther.textContent = Math.round(totalSelfStudyOther);
        tableCells.totalOtherHours.textContent = ((totalSelfStudyPeriods + totalAssessmentPeriods) * 50 / 60).toFixed(1);
        tableCells.totalTheory.textContent = Math.round(totalTheoryTeaching + totalTheoryOther);
        tableCells.totalPractice.textContent = Math.round(totalPracticeTeaching + totalPracticeOther);
        tableCells.totalSelfStudy.textContent = Math.round(totalSelfStudyTeaching + totalSelfStudyOther);
        tableCells.totalHours.textContent = ((totalSyncPeriods + totalAsyncPeriods + totalLmsPeriods + totalCorrespondencePeriods + totalSelfStudyPeriods + totalAssessmentPeriods) * 50 / 60).toFixed(1);

        const requiredHours = totalCredits * 50;
        const totalHoursNumber = (totalSyncPeriods + totalAsyncPeriods + totalLmsPeriods + totalCorrespondencePeriods + totalSelfStudyPeriods + totalAssessmentPeriods) * 50 / 60;
        const hoursNeeded = requiredHours - totalHoursNumber;
        hoursRequiredSpan.textContent = Math.round(requiredHours);
        hoursNeededSpan.textContent = hoursNeeded > 0 ? Math.round(hoursNeeded) : 0;
        suggestionMessage.style.display = totalCredits > 0 && hoursNeeded > 0 ? 'block' : 'none';
        errorMessage.style.display = totalCredits === 0 ? 'block' : 'none';
    }

    function markAsEdited(event) {
        event.target.dataset.edited = 'true';
    }

    theoryCreditsInput.addEventListener('input', () => {
        Object.values(tableInputs).forEach(input => delete input.dataset.edited);
        updateAllocation();
    });
    practiceCreditsInput.addEventListener('input', () => {
        Object.values(tableInputs).forEach(input => delete input.dataset.edited);
        updateAllocation();
    });
    Object.values(tableInputs).forEach(input => {
        input.addEventListener('input', markAsEdited);
        input.addEventListener('input', updateAllocation);
    });

    function exportToWord() { /* ...gi·ªØ nguy√™n nh∆∞ b·∫£n g·ªëc... */ 
        // Kh√¥ng li√™n quan ƒë·∫øn l·ªói n√†y, b·∫°n c√≥ th·ªÉ gi·ªØ code c≈©.
    }

    function exportToHTML() {
        const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
        const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;
        const totalCredits = theoryCredits + practiceCredits;

        const tableClone = document.getElementById('allocation-table').cloneNode(true);
        const rows = tableClone.querySelectorAll('tbody tr');
        rows.forEach(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length === 5) {
                let vals = [];
                for (let i = 1; i <= 3; i++) {
                    let v = 0;
                    const inp = cells[i].querySelector('input') || cells[i].querySelector('span');
                    if (inp) v = parseFloat(inp.value || inp.textContent) || 0;
                    vals.push(v);
                    if (cells[i].querySelector('input')) {
                        const span = document.createElement('span');
                        span.textContent = v;
                        cells[i].replaceChild(span, cells[i].querySelector('input'));
                    }
                }
                let totalPeriods = vals.reduce((a, b) => a + b, 0);
                let totalHours = (totalPeriods * 50 / 60).toFixed(1);
                cells[4].textContent = totalHours;
            }
        });

        const htmlContent = `
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√¢n b·ªï c√°c lo·∫°i gi·ªù - K·∫øt qu·∫£</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        h1 { text-align: center; color: #333; }
        h2 { color: #333; margin-top: 20px; }
        .info-section { margin: 20px 0; padding: 15px; background-color: #f9f9f9; border-radius: 5px; }
        .info-item { margin: 5px 0; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .footer { margin-top: 30px; font-size: 12px; color: #666; }
        @media print { body { margin: 0; } .no-print { display: none; } }
    </style>
</head>
<body>
    <h1>PH√ÇN B·ªî C√ÅC LO·∫†I GI·ªú<br/>(D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</h1>
    <div class="info-section">
        <h2>Th√¥ng tin h·ªçc ph·∫ßn</h2>
        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ l√Ω thuy·∫øt:</strong> ${theoryCredits}</div>
        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ th·ª±c h√†nh:</strong> ${practiceCredits}</div>
        <div class="info-item"><strong>T·ªïng s·ªë t√≠n ch·ªâ:</strong> ${totalCredits}</div>
        <div class="info-item"><strong>T·ª± h·ªçc (ti·∫øt):</strong> ${Math.round(totalCredits * 30)}</div>
    </div>
    <h2>Ph√¢n b·ªï c·ª• th·ªÉ</h2>
    ${tableClone.outerHTML}
    <div class="info-section">
        <h2>Ghi ch√∫</h2>
        <ul>
            <li>1 ti·∫øt = 50 ph√∫t</li>
            <li>T·ªïng s·ªë gi·ªù y√™u c·∫ßu: ${Math.round(totalCredits * 50)} gi·ªù</li>
            <li>Ng√†y t·∫°o: ${new Date().toLocaleDateString('vi-VN')} ${new Date().toLocaleTimeString('vi-VN')}</li>
        </ul>
    </div>
    <div class="footer">
        <p>T√†i li·ªáu ƒë∆∞·ª£c t·∫°o t·ª´ ph√≤ng QLƒêT</p>
    </div>
</body>
</html>
        `;

        const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.href = url;
        link.download = `Phan_bo_gio_hoc_${totalCredits}tc_${new Date().getTime()}.html`;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
        alert('File HTML ƒë√£ ƒë∆∞·ª£c t·∫°o v√† t·∫£i xu·ªëng!');
    }

    function printTable() {
        const theoryCredits = parseFloat(theoryCreditsInput.value) || 0;
        const practiceCredits = parseFloat(practiceCreditsInput.value) || 0;
        const totalCredits = theoryCredits + practiceCredits;

        const printWindow = window.open('', '_blank');
        const tableClone = document.getElementById('allocation-table').cloneNode(true);
        const rows = tableClone.querySelectorAll('tbody tr');
        rows.forEach(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length === 5) {
                let vals = [];
                for (let i = 1; i <= 3; i++) {
                    let v = 0;
                    const inp = cells[i].querySelector('input') || cells[i].querySelector('span');
                    if (inp) v = parseFloat(inp.value || inp.textContent) || 0;
                    vals.push(v);
                    if (cells[i].querySelector('input')) {
                        const span = document.createElement('span');
                        span.textContent = v;
                        cells[i].replaceChild(span, cells[i].querySelector('input'));
                    }
                }
                let totalPeriods = vals.reduce((a, b) => a + b, 0);
                let totalHours = (totalPeriods * 50 / 60).toFixed(1);
                cells[4].textContent = totalHours;
            }
        });

        const printContent = `
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>In - Ph√¢n b·ªï c√°c lo·∫°i gi·ªù</title>
    <style>
        body { font-family: 'Times New Roman', serif; font-size: 12pt; margin: 20px; }
        h1 { text-align: center; font-size: 16pt; font-weight: bold; margin-bottom: 20px; }
        h2 { font-size: 14pt; font-weight: bold; margin: 15px 0 10px 0; }
        .info-section { margin: 15px 0; }
        .info-item { margin: 3px 0; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { border: 1px solid black; padding: 6px; text-align: center; font-size: 11pt; }
        th { background-color: #f0f0f0; font-weight: bold; }
        .footer { margin-top: 20px; font-size: 10pt; }
    </style>
</head>
<body>
    <h1>PH√ÇN B·ªî C√ÅC LO·∫†I GI·ªú<br/>(D√†nh cho h·ªá ƒê√†o t·∫°o t·ª´ xa)</h1>
    <div class="info-section">
        <h2>Th√¥ng tin h·ªçc ph·∫ßn</h2>
        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ l√Ω thuy·∫øt:</strong> ${theoryCredits}</div>
        <div class="info-item"><strong>S·ªë t√≠n ch·ªâ th·ª±c h√†nh:</strong> ${practiceCredits}</div>
        <div class="info-item"><strong>T·ªïng s·ªë t√≠n ch·ªâ:</strong> ${totalCredits}</div>
        <div class="info-item"><strong>T·ª± h·ªçc (ti·∫øt):</strong> ${Math.round(totalCredits * 30)}</div>
    </div>
    <h2>Ph√¢n b·ªï c·ª• th·ªÉ</h2>
    ${tableClone.outerHTML}
    <div class="footer">
        <p><strong>Ghi ch√∫:</strong> 1 ti·∫øt = 50 ph√∫t | T·ªïng s·ªë gi·ªù y√™u c·∫ßu: ${Math.round(totalCredits * 50)} gi·ªù</p>
        <p>Ng√†y in: ${new Date().toLocaleDateString('vi-VN')} ${new Date().toLocaleTimeString('vi-VN')}</p>
    </div>
</body>
</html>
        `;

        printWindow.document.write(printContent);
        printWindow.document.close();
        printWindow.onload = function() {
            printWindow.print();
            printWindow.close();
        };
    }

    updateAllocation();
</script>
</body>
</html>